<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#121212">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronos Assistant</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/4712/4712009.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div id="splash-screen">
        <div class="deep-space-bg"></div>
        <div class="particle-system">
            <div class="core-void"></div>
            <div class="particle-ring layer-1"></div>
            <div class="particle-ring layer-2"></div>
            <div class="particle-ring layer-3"></div>
            <div class="particle-ring layer-4"></div>
        </div>
        <div class="ui-container">
            <h1 class="system-title" id="titulo-ia-splash">CHRONOS <span class="blink">AI</span></h1>
            <p class="loading-text">SINCRONIZANDO O SISTEMA...</p>
        </div>
    </div>

    <div class="app-container">
        <header class="header-principal" style="display: flex; justify-content: space-between; align-items: start;">
            <div>
                <h1 id="saudacao-texto">Carregando...</h1>
                <p class="data-layer">
                    <span id="data-atual-home">Carregando data...</span>
                    <span style="margin: 0 8px; opacity: 0.5;">|</span>
                    <span id="relogio-home" style="color: var(--primary-color); font-weight: bold;">00:00:00</span>
                </p>
            </div>
            <button onclick="mostrarSecao('config')"
                style="background:none; border:none; cursor:pointer; font-size: 1.2rem; filter: drop-shadow(0 0 5px var(--primary-color));">‚öôÔ∏è</button>
        </header>

        <main>
            <section id="view-home" class="view">
                <div class="card saldo-card">
                    <p style="color: #888; font-size: 0.9rem;">Balan√ßo Total</p>
                    <h1 id="resumo-saldo-home">R$ 0,00</h1>
                    <div style="height: 100px; margin-top: 15px;">
                        <canvas id="grafico-resumo-home"></canvas>
                    </div>
                    <div id="streak-container"
                        style="margin-top: 15px; font-weight: bold; color: #ff9f43; display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 1.2rem;">üî•</span> Sequ√™ncia: <span id="streak-count">0</span> dias
                    </div>
                </div>

                <div class="card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3>üéØ Foco de Hoje</h3>
                        <span id="contagem-tarefas" class="badge">0</span>
                    </div>
                    <div id="lista-resumo-home"></div>
                    <button class="link-btn" onclick="mostrarSecao('agenda')">Ver Agenda Completa ‚Üí</button>
                </div>
                <div class="card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3>üí∞ √öltimas Movimenta√ß√µes</h3>
                    </div>
                    <div id="lista-financas-home"></div>
                </div>

                <div class="card-dashboard system-card" onclick="abrirSistema()">
                    <div class="card-header">
                        <h3>‚ö° SISTEMA <span class="lvl-badge-mini" id="home-lvl">LVL 1</span></h3>
                        <span id="status-quest-mini" class="status-badge">PENDENTE</span>
                    </div>
                    <div class="card-body">
                        <p class="system-text">Daily Quest: <strong>Player Growth</strong></p>
                        <div class="progress-track">
                            <div class="progress-fill" id="barra-progresso-home" style="width: 0%"></div>
                        </div>
                        <p class="small-text">Complete para ganhar XP e Status.</p>
                    </div>
                </div>
            </section>

            <section id="view-agenda" class="view hidden">
                <h2>Sua Agenda</h2>
                <div class="card dashboard-card">
                    <div style="width: 110px; height: 110px;">
                        <canvas id="grafico-tarefas"></canvas>
                    </div>
                    <div style="text-align: right;">
                        <h3 id="texto-progresso" style="font-size: 2rem; color: #00d4ff;">0%</h3>
                        <p style="color: #888; font-size: 0.8rem;">Conclu√≠do</p>
                    </div>
                </div>
                <button class="action-btn" onclick="abrirModal()">+ Nova Tarefa</button>
                <div id="lista-tarefas" style="margin-top: 20px;"></div>
            </section>

            <section id="view-carteira" class="view hidden">
                <h2>Finan√ßas</h2>
                <div class="card" style="text-align: center;">
                    <p>Saldo em conta</p>
                    <h1 id="saldo-carteira" style="font-size: 2.5rem;">R$ 0,00</h1>
                </div>
                <button onclick="window.location.href='financeiro/index.html'"
                    style="width: 100%; background: #00d4ff; color: #000; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">
                    ‚ûï REGISTRAR GASTO
                </button>
                <div class="card" style="height: 180px;">
                    <canvas id="grafico-financas"></canvas>
                </div>
                <div class="card" style="height: 280px; padding: 20px;">
                    <h3 style="font-size: 0.9rem; color: #888; margin-bottom: 5px;">Gastos por Categoria</h3>
                    <div style="width: 100%; height: 100%; position: relative;">
                        <canvas id="grafico-pizza-financas"></canvas>
                    </div>
                </div>
                <div class="card">
                    <button class="action-btn" onclick="abrirModalFinanceiro()">+ Nova Transa√ß√£o</button>
                    <button onclick="analisarFinancas()" class="ai-btn">‚ú® Consultar Or√°culo</button>
                    <div id="resposta-ia" class="card hidden ia-box">
                        <h3 style="color: #00d4ff;">Conselho do Or√°culo:</h3>
                        <p id="texto-ia">Pensando...</p>
                    </div>
                </div>
                <div class="historico-container">
                    <h3>Hist√≥rico Recente</h3>
                    <div id="lista-transacoes"></div>
                </div>
            </section>

            <section id="view-config" class="view hidden">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                    <button onclick="mostrarSecao('home')"
                        style="background:none; border:none; color:var(--primary-color); font-size: 1.2rem; cursor:pointer;">‚Üê</button>
                    <h2>Configura√ß√µes</h2>
                </div>
                <div class="card">
                    <h3>üë§ Identidade</h3>
                    <p style="color: #888; font-size: 0.75rem; margin-bottom: 10px;">Como o Zeus deve te chamar?</p>
                    <input type="text" id="config-nome-input" class="input-dark" placeholder="Novo nome...">
                    <button class="action-btn" onclick="salvarNovoNome()">Salvar Nome</button>
                </div>
                <div class="card" id="card-auth-google">
                    <h3>üîê Conta do Google</h3>
                    <p id="auth-status-texto" style="color: #888; font-size: 0.75rem; margin-bottom: 15px;">Sincronize
                        seus dados na nuvem.</p>

                    <button id="btn-login-google" onclick="login()" class="action-btn"
                        style="background: #4285F4; display: none;">
                        Entrar com Google
                    </button>

                    <button id="btn-logout-google" onclick="logout()" class="action-btn"
                        style="background: #ff4444; display: none; margin-top: 10px;">
                        Sair da Conta
                    </button>
                </div>
                <div class="card">
                    <h3>üîê Seguran√ßa (Or√°culo)</h3>
                    <p style="color: #888; font-size: 0.75rem; margin-bottom: 10px;">Insira sua API Key do Gemini.</p>
                    <input type="password" id="config-api-key" class="input-dark" placeholder="Cole sua chave AIza...">
                    <button class="action-btn" onclick="salvarApiKey()">Configurar Chave</button>
                </div>
                <div class="card">
                    <h3>üìÖ Integra√ß√£o com Agenda</h3>
                    <p style="color: #888; font-size: 0.75rem; margin-bottom: 15px;">Conecte sua conta para sincronizar
                        miss√µes.</p>
                    <button class="action-btn" onclick="iniciarConexaoGoogle()" style="background: #4285F4;">Conectar
                        Google Calendar</button>
                </div>
                <button onclick="logout()" class="action-btn" style="background: #ff4444; margin-top: 10px;">
                    Sair (Logout)
                </button>
                <div class="card">
                    <h3>üîê Chaves de Seguran√ßa (Telegram)</h3>
                    <p style="font-size: 0.8rem; color: #aaa;">
                        Necess√°rio para fazer upload de arquivos. Essas chaves ficam salvas apenas no seu dispositivo.
                    </p>

                    <label style="color: #00d4ff; font-size: 0.8rem;">Bot Token:</label>
                    <input type="password" id="config-telegram-token" class="input-dark"
                        placeholder="Ex: 123456:ABC-Def..." style="margin-bottom: 10px;">

                    <label style="color: #00d4ff; font-size: 0.8rem;">Chat ID:</label>
                    <input type="text" id="config-chat-id" class="input-dark" placeholder="Ex: -100517..."
                        style="margin-bottom: 10px;">

                    <button onclick="salvarConfigTelegram()" class="action-btn" style="width: 100%;">
                        üíæ Salvar Chaves
                    </button>
                </div>
            </section>
            <section id="view-estudos" class="view hidden">
                <h2>üéì Central Acad√™mica</h2>

                <div class="card" style="background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);">
                    <h3 style="color:white; text-align:center;">CFO MARANH√ÉO</h3>
                    <div id="countdown-cfo"
                        style="font-size: 2rem; font-weight: bold; text-align: center; margin: 10px 0;">
                        00d 00h 00m
                    </div>
                    <p style="text-align: center; font-size: 0.8rem; color: #eee;">At√© a prova</p>
                </div>

                <div class="card">
                    <h3>üìä Status das Mat√©rias</h3>

                    <div class="materia-item">
                        <div class="materia-info">
                            <span>‚öñÔ∏è Direito / Legisla√ß√£o</span>
                            <span id="prog-direito-txt">0%</span>
                        </div>
                        <div class="progress-track">
                            <div id="prog-direito-bar" class="progress-fill" style="background: #ff4d4d;"></div>
                        </div>
                    </div>

                    <div class="materia-item">
                        <div class="materia-info">
                            <span>üíª Inform√°tica (SQL/Python)</span>
                            <span id="prog-ti-txt">0%</span>
                        </div>
                        <div class="progress-track">
                            <div id="prog-ti-bar" class="progress-fill" style="background: #00d4ff;"></div>
                        </div>
                    </div>

                    <div class="materia-item">
                        <div class="materia-info">
                            <span>üìö Portugu√™s / Reda√ß√£o</span>
                            <span id="prog-port-txt">0%</span>
                        </div>
                        <div class="progress-track">
                            <div id="prog-port-bar" class="progress-fill" style="background: #2ecc71;"></div>
                        </div>
                    </div>

                    <div class="materia-item">
                        <div class="materia-info">
                            <span>üßÆ Matem√°tica / RLM</span>
                            <span id="prog-mat-txt">0%</span>
                        </div>
                        <div class="progress-track">
                            <div id="prog-mat-bar" class="progress-fill" style="background: #f1c40f;"></div>
                        </div>
                    </div>

                    <div class="materia-item">
                        <div class="materia-info">
                            <span>üö© Hist./Geo. Maranh√£o</span>
                            <span id="prog-ma-txt">0%</span>
                        </div>
                        <div class="progress-track">
                            <div id="prog-ma-bar" class="progress-fill" style="background: #9b59b6;"></div>
                        </div>
                    </div>
                </div>
            </section>
            <section id="view-grimorio" class="view hidden">
                <header class="header-secao">
                    <h2>üìú Grim√≥rio de Saber</h2>
                    <p class="data-layer">Conhecimento Sincronizado</p>
                </header>

                <div class="card" id="form-inscricao">
                    <h3>‚ú® Nova Inscri√ß√£o</h3>
                    <div class="materia-item">
                        <select id="grimorio-categoria" class="input-dark"
                            style="width: 100%; margin-bottom: 10px; border: 1px solid var(--primary-color);">
                            <option value="CFO">‚öîÔ∏è Senda do Guerreiro (CFO)</option>
                            <option value="Pedagogia">üçé Senda da Mestra (Pedagogia)</option>
                            <option value="Geral">‚öôÔ∏è Outros Saberes</option>
                        </select>

                        <input type="text" id="grimorio-titulo" class="input-dark"
                            placeholder="T√≠tulo do Documento (Ex: Direito Penal)">
                        <label style="color: #aaa; font-size: 0.8rem; margin-top: 10px;">Carregar Arquivo
                            (PDF/Img):</label>
                        <input type="file" id="input-arquivo-upload" class="input-dark"
                            accept="application/pdf, image/*">

                        <textarea id="grimorio-resumo" class="input-dark" style="height: 80px; margin-top: 10px;"
                            placeholder="Breve resumo ou notas da IA..."></textarea>

                        <input type="text" id="grimorio-link-telegram" class="input-dark" style="margin-top: 10px;"
                            placeholder="Link do Arquivo (Telegram/Cloud)">

                        <button onclick="adicionarAoGrimorio()" class="action-btn"
                            style="margin-top: 15px; width: 100%;">
                            Consagrar no Firestore
                        </button>
                        <button onclick="iniciarConsagracaoFinal()" id="btn-consagrar" class="action-btn"
                            style="margin-top: 15px; width: 100%;">
                            üì§ Enviar e Consagrar (Arquivo)
                        </button>
                    </div>
                </div>

                <div id="lista-grimorio" class="grimorio-container"
                    ,="display: flex; flex-direction: column; gap: 18px; margin-top: 20px;">
                </div>
            </section>
        </main>

        <nav class="bottom-nav">
            <button class="nav-btn" onclick="mostrarSecao('agenda')">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <span>Agenda</span>
            </button>
            <button class="nav-btn" onclick="mostrarSecao('estudos')">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
                    <path d="M6 12v5c3 3 9 3 12 0v-5"></path>
                </svg>
                <span>Estudos</span>
            </button>
            <button class="nav-btn home-btn" onclick="mostrarSecao('home')">
                <div class="neon-reactor">
                    <div class="core"></div>
                </div>
            </button>
            <button class="nav-btn" onclick="mostrarSecao('grimorio')">
                <div class="nav-icon-container">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                        <path d="M9 7h7"></path>
                        <path d="M9 11h7"></path>
                    </svg>
                </div>
                <span>Grim√≥rio</span>
            </button>
            <button class="nav-btn" onclick="mostrarSecao('carteira')">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M20 7h-5a4 4 0 1 0 0 8h5"></path>
                    <path d="M4 17h16a2 2 0 0 0 2-2v-10a2 2 0 0 0 -2 -2h-16a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2z"></path>
                    <circle cx="16" cy="11" r="1" fill="currentColor"></circle>
                </svg>
                <span>Carteira</span>
            </button>
        </nav>
    </div>

    <div id="modal-tarefa" class="modal hidden">
        <div class="modal-content">
            <h3>Nova Miss√£o</h3>
            <label>O que precisa ser feito?</label>
            <input type="text" id="input-titulo" placeholder="Ex: Estudar SQL">
            <label>Categoria</label>
            <select id="input-categoria">
                <option value="Estudo">üìö Estudo</option>
                <option value="Trabalho">üíº Trabalho</option>
                <option value="Pessoal">‚ö° Pessoal</option>
            </select>
            <div class="modal-buttons">
                <button onclick="fecharModal()" class="btn-cancelar">Cancelar</button>
                <button onclick="salvarTarefa()" class="btn-confirmar">Salvar</button>
            </div>
        </div>
    </div>

    <div id="modal-transacao" class="modal hidden">
        <div class="modal-content">
            <h3>Nova Movimenta√ß√£o</h3>
            <label>Descri√ß√£o</label>
            <input type="text" id="input-desc-transacao" placeholder="Ex: Sal√°rio, Lanche...">
            <label>Valor (R$)</label>
            <input type="number" id="input-valor-transacao" placeholder="0.00" step="0.01">
            <label>Tipo</label>
            <select id="input-tipo-transacao">
                <option value="entrada">üìà Entrada (Receita)</option>
                <option value="saida">üìâ Sa√≠da (Despesa)</option>
            </select>
            <label>Categoria do Gasto</label>
            <select id="input-categoria-transacao">
                <option value="Alimenta√ß√£o">üçï Alimenta√ß√£o</option>
                <option value="Transporte">üöó Transporte</option>
                <option value="Lazer">üéÆ Lazer</option>
                <option value="Educa√ß√£o">üìö Educa√ß√£o</option>
                <option value="Sa√∫de">üè• Sa√∫de</option>
                <option value="Outros">‚öôÔ∏è Outros</option>
            </select>
            <div class="modal-buttons">
                <button onclick="fecharModalFinanceiro()" class="btn-cancelar">Cancelar</button>
                <button onclick="salvarTransacao()" class="btn-confirmar-fin">Confirmar</button>
            </div>
        </div>
    </div>

    <div id="modal-agendamento" class="modal hidden">
        <div class="modal-content modal-tatica">
            <h3>üìÖ Agendar Miss√£o</h3>
            <p id="titulo-agendamento">...</p>
            <label>Data e Hora de In√≠cio</label>
            <input type="datetime-local" id="input-data-hora" class="input-dark">
            <div class="modal-buttons">
                <button onclick="fecharModalAgendamento()" class="btn-cancelar">Cancelar</button>
                <button onclick="confirmarAgendamento()" class="btn-confirmar-agenda">Confirmar</button>
            </div>
        </div>
    </div>

    <div id="modal-sistema" class="modal-overlay hidden">
        <div class="system-window">
            <div class="sys-header-complex">
                <div class="header-top">
                    <h2 class="blink-anim">PLAYER STATUS</h2>
                    <button onclick="fecharSistema()" class="btn-close-sys">‚úñ</button>
                </div>

                <div class="player-stats">
                    <div class="level-box">
                        <span class="label">LEVEL</span>
                        <span class="value-lvl" id="display-lvl">1</span>
                    </div>
                    <div class="xp-container">
                        <div class="xp-info">
                            <span>EXP</span>
                            <span id="display-xp">0 / 100</span>
                        </div>
                        <div class="xp-track">
                            <div class="xp-fill" id="bar-xp" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sys-content">
                <h1 class="quest-title">PREPARA√á√ÉO F√çSICA</h1>
                <p class="quest-sub">Objetivos Di√°rios do Jogador</p>
                <div class="separator-line"></div>

                <div id="lista-exercicios">
                </div>

                <div id="msg-recompensa" class="reward-box hidden">
                    <p>‚ö†Ô∏è QUEST COMPLETA</p>
                    <span>Status Recuperado</span>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="./js/script.js"></script>
</body>

</html>